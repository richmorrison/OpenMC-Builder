# OpenMC-Builder

A shell script to download and compile [OpenMC source code](https://github.com/openmc-dev/openmc) and all dependencies.

This script also downloads and compiles the dependencies for OpenMC, and places them in the local directory tree. Unless something goes wrong (e.g. accidentally running the script with `sudo` in a system directory) no changes are made to the "OS" parts of the filesystem. There is no need to run with `sudo`.

This script assumes the following packages are installed and available on the host system:

* build-essential
* m4
* cmake
* gfortran
* python3-dev
* python3-venv

For a [Debian](https://www.debian.org) based system (such as [Ubuntu](https://ubuntu.com), these are installed with:

>`sudo apt get install build-essential m4 cmake gfortran python3-dev python3-venv`

After compilation of serial and [MPI](https://www.mpi-forum.org) versions of OpenMC is complete, Python [venv](https://https://docs.python.org/3/library/venv.html)'s are also built, with all Python dependencies installed, ready to be activated as any other Python `venv`. Nuclear data is also retrieved. References to nuclear data locations either from the Python API or environment variables must be created. (It is possible to put references to a preferred nuclear data library inside the Python `venv` definitions.)

Downloaded source for dependencies is kept by the script for record.

The script creates three directory trees for MPI and serial versions of OpenMC and dependencies. Where a dependency can only be compiled as a serial version it is installed to the `install` directory. Where a dependency can be compiled as both serial and MPI, it is installed to `install_serial`and `install_mpi` respectively. Objects linking to libraries first search `install` for libraries and headers, and then either `install_serial` or `install_mpi` depending on the intended object.

I don't believe I've included all necessary dependencies for the more advanced uses of OpenMC. The [OpenMC Dockerfile](https://github.com/openmc-dev/openmc/blob/develop/Dockerfile) is a good place to look for an overview of all available options.

It is not my intent to keep this script frequently updated against newer versions of OpenMC and dependencies. I will update it as/when I need. However, up-versioning the various libraries etc. should be straight-forward.

When updating this script, my intent is to link to the latest version of dependencies, so inevitably some dependency versions will likely be slightly ahead of those used by the OpenMC maintainers during testing. Therefore, it should be assumed that the output generated by this script does not resemble the official OpenMC binary (or that contained in the official [OpenMC docker image](https://hub.docker.com/r/openmc/openmc), which is presumably used in testing). For a version of OpenMC that reflects a QA tested version, see the [OpenMC project page](https://https://openmc.org).

I'm not affiliated with the OpenMC dev team. I refer you to the [OpenMC project documentation](https://docs.openmc.org) for compilation information and checked/tested/correct compilation/methods.